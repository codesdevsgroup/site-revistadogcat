<section class="article-detail container py-4" *ngIf="!loading && !error">
  <article *ngIf="artigo as a" class="article">
    <header class="article-header">
      <h1 class="title">{{ a.titulo }}</h1>
      <div class="meta">
        <span class="author">✍️ {{ a.autor }}</span>
        <span class="date" [attr.datetime]="a.dataPublicacao"
          >{{ a.dataPublicacao | date:'dd/MM/yyyy' }}</span
        >
        <span class="category" *ngIf="a.categoria">{{ a.categoria }}</span>
      </div>

      <!-- Estatísticas do artigo -->
      <div class="article-stats">
        <span class="stat-item" title="Visualizações">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="18"
            height="18"
            fill="currentColor"
            viewBox="0 0 16 16"
          >
            <path
              d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8M1.173 8a13 13 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5s3.879 1.168 5.168 2.457A13 13 0 0 1 14.828 8q-.086.13-.195.288c-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5s-3.879-1.168-5.168-2.457A13 13 0 0 1 1.172 8z"
            />
            <path
              d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5M4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0"
            />
          </svg>
          {{ totalVisualizacoes }}
        </span>
        <button
          class="stat-item like-button"
          [class.liked]="curtido"
          [disabled]="processandoCurtida"
          (click)="toggleCurtida()"
          [title]="curtido ? 'Remover curtida' : 'Curtir artigo'"
        >
          <svg
            *ngIf="!curtido"
            xmlns="http://www.w3.org/2000/svg"
            width="18"
            height="18"
            fill="currentColor"
            viewBox="0 0 16 16"
          >
            <path
              d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143q.09.083.176.171a3 3 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15"
            />
          </svg>
          <svg
            *ngIf="curtido"
            xmlns="http://www.w3.org/2000/svg"
            width="18"
            height="18"
            fill="currentColor"
            viewBox="0 0 16 16"
          >
            <path
              fill-rule="evenodd"
              d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"
            />
          </svg>
          {{ totalCurtidas }}
        </button>
      </div>

      <img
        *ngIf="a.imagemCapa"
        class="cover"
        [src]="('/api' + '/artigos/imagem/' + a.imagemCapa)"
        [alt]="a.titulo"
      />
    </header>
    <section class="content" [innerHTML]="conteudoSeguro"></section>

    <!-- Ações de interação no final do artigo -->
    <footer class="article-footer">
      <div class="interaction-section">
        <p class="interaction-text">Gostou deste artigo?</p>
        <button
          class="btn-like-large"
          [class.liked]="curtido"
          [disabled]="processandoCurtida"
          (click)="toggleCurtida()"
        >
          <svg
            *ngIf="!curtido"
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            fill="currentColor"
            viewBox="0 0 16 16"
          >
            <path
              d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143q.09.083.176.171a3 3 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15"
            />
          </svg>
          <svg
            *ngIf="curtido"
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            fill="currentColor"
            viewBox="0 0 16 16"
          >
            <path
              fill-rule="evenodd"
              d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314"
            />
          </svg>
          <span *ngIf="!curtido">Curtir</span>
          <span *ngIf="curtido">Curtido</span>
        </button>
        <p class="likes-count">
          {{ totalCurtidas }} {{ totalCurtidas === 1 ? 'pessoa curtiu' :
          'pessoas curtiram' }}
        </p>
      </div>
    </footer>
  </article>
  <nav class="article-actions mt-4">
    <a
      class="btn btn-secondary btn-ripple"
      routerLink="/artigos"
      title="Voltar para lista"
      >← Voltar para artigos</a
    >
  </nav>
</section>

<div *ngIf="loading" class="loading">Carregando artigo...</div>
<div *ngIf="error" class="error" role="alert">{{ error }}</div>
